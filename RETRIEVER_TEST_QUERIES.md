# Retriever 테스트 질의 추천

이 문서는 3가지 Retriever (Text2Cypher, Vector, VectorCypher)를 각각 테스트할 수 있는 질의 예시를 제공합니다.

## Retriever 선택 로직

현재 시스템은 질의 내용에 따라 자동으로 Retriever를 선택합니다:

- **Text2Cypher**: 구조적 질문 (언론사, 카테고리, 관계 등)
- **Vector**: 짧은 의미 검색 (5단어 이하)
- **VectorCypher**: 긴 질문 또는 분석형 질문

---

## 1. Text2Cypher Retriever 테스트

**선택 조건**: 구조적 키워드 포함 + 분석형 키워드 없음

### 추천 질의

1. **카테고리 관련**
   - "모든 카테고리 목록을 보여줘"
   - "카테고리별 기사 수는 몇 개야?"
   - "어떤 카테고리가 가장 많은 기사를 가지고 있어?"

2. **언론사 관련**
   - "언론사 목록을 알려줘"
   - "어떤 언론사가 가장 많은 기사를 발행했어?"
   - "각 언론사별 기사 수는?"

3. **관계 질문**
   - "기사와 카테고리의 관계는?"
   - "언론사가 발행한 기사 목록"
   - "특정 카테고리에 속한 기사들"

4. **구조적 질문**
   - "데이터베이스에 있는 모든 노드 타입은?"
   - "기사와 콘텐츠의 관계 구조는?"

---

## 2. Vector Retriever 테스트

**선택 조건**: 5단어 이하 + 분석형 키워드 없음

### 추천 질의

1. **단일 키워드**
   - "AI"
   - "경제"
   - "정치"
   - "기술"

2. **짧은 구문 (2-3단어)**
   - "해킹 방지"
   - "인공지능 기술"
   - "경제 뉴스"
   - "정치 동향"
   - "금융 시장"

3. **짧은 질문 (4-5단어)**
   - "최근 AI 뉴스"
   - "경제 관련 기사"
   - "기술 트렌드"
   - "정치 분석"

**주의**: "해킹 방지하는 방법"은 4단어이므로 Vector가 선택되지만, 실제로는 관련 없는 노드가 선택될 수 있습니다. 이는 임베딩 모델의 한계일 수 있습니다.

---

## 3. VectorCypher Retriever 테스트

**선택 조건**: 긴 질문 (6단어 이상) 또는 분석형 키워드 포함

### 추천 질의

1. **분석형 질문**
   - "최근 AI 기술 동향을 분석해줘"
   - "경제 뉴스의 주요 트렌드를 요약해줘"
   - "정치 관련 기사들을 비교 분석해줘"
   - "기술 분야의 패턴을 찾아줘"

2. **긴 질문**
   - "최근 1개월간 인공지능 관련 뉴스 요약"
   - "경제 분야에서 가장 많이 다뤄진 주제는?"
   - "정치 뉴스에서 반복적으로 나타나는 키워드는?"

3. **복합 질문**
   - "특정 카테고리의 AI 관련 기사 요약"
   - "언론사별로 발행한 경제 뉴스 비교"
   - "카테고리별 기술 트렌드 분석"

4. **의미 기반 + 그래프 탐색**
   - "AI와 관련된 기사 중에서 가장 최근 것들"
   - "경제 뉴스에서 언급된 주요 기업들"
   - "정치 기사와 연결된 카테고리 분석"

---

## 테스트 시나리오

### 시나리오 1: 각 Retriever 개별 테스트

1. **Text2Cypher 테스트**
   ```
   질의: "모든 카테고리 목록을 보여줘"
   예상 Retriever: text2cypher
   ```

2. **Vector 테스트**
   ```
   질의: "AI"
   예상 Retriever: vector
   ```

3. **VectorCypher 테스트**
   ```
   질의: "최근 AI 기술 동향을 분석해줘"
   예상 Retriever: vector_cypher
   ```

### 시나리오 2: 유사한 주제, 다른 Retriever

1. **Vector (짧은 질문)**
   ```
   질의: "AI 뉴스"
   ```

2. **VectorCypher (긴 질문)**
   ```
   질의: "최근 AI 관련 뉴스의 주요 동향을 분석해줘"
   ```

### 시나리오 3: 정확도 비교

같은 주제에 대해 다른 Retriever를 강제로 사용하여 결과 비교:

- Text2Cypher: 구조적 정보 (카테고리, 언론사 등)
- Vector: 의미 기반 검색 (짧은 키워드)
- VectorCypher: 의미 + 그래프 탐색 (복합 질문)

---

## 주의사항

1. **Vector Retriever의 한계**
   - 짧은 키워드 검색 시 관련 없는 노드가 선택될 수 있음
   - 임베딩 모델의 한계로 인해 의미적으로 유사하지만 실제로는 관련 없는 콘텐츠가 포함될 수 있음
   - 예: "해킹 방지" 검색 시 검찰청 관련 기사가 선택될 수 있음

2. **Text2Cypher의 한계**
   - LLM이 생성한 Cypher 쿼리가 잘못될 수 있음
   - 복잡한 질문은 처리하지 못할 수 있음

3. **VectorCypher의 장점**
   - 의미 검색 + 그래프 탐색을 결합하여 더 정확한 결과 제공
   - 관련 노드들을 그래프 구조를 통해 확장하여 검색

---

## 로그 확인 방법

서버 터미널에서 다음 로그를 확인하세요:

```
[SEARCH] 질의: [질의 내용]
[SEARCH] 사용된 Retriever: [retriever_name]
[SEARCH] 초기 검색 결과: 노드 X개, 엣지 Y개
  노드 1: ID=..., 타입=..., 레이블=..., 점수=...
[SEARCH] 필터링 후: 노드 X개, 엣지 Y개
[SEARCH] 최종 반환 노드 ID 목록: [...]
[LLM] 생성된 답변 길이: X자
[LLM] 답변 미리보기: ...
```

이 로그를 통해 어떤 Retriever가 선택되었는지, 몇 개의 노드가 검색되었는지, 각 노드의 점수는 얼마인지 확인할 수 있습니다.

